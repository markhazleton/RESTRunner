<!DOCTYPE html>
<html>
<head>
    <title>Configuration Debug</title>
    <style>
        body { font-family: monospace; margin: 20px; }
        .debug-info { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .error { background: #ffe6e6; }
        .success { background: #e6ffe6; }
        pre { white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>
    <h1>Configuration Debug Tool</h1>
    
    <div class="debug-info">
        <h3>Test Configuration ID</h3>
        <input type="text" id="configId" placeholder="Enter configuration ID (e.g., 9e068100-eb4f-46e3-a415-fc7c2bef7b48)" style="width: 400px;">
        <button onclick="debugConfig()">Debug</button>
    </div>
    
    <div id="results"></div>
    
    <script>
        function debugConfig() {
            const configId = document.getElementById('configId').value.trim();
            if (!configId) {
                alert('Please enter a configuration ID');
                return;
            }
            
            fetch(`/Configuration/DebugEdit/${configId}`)
                .then(response => response.json())
                .then(data => {
                    const resultsDiv = document.getElementById('results');
                    resultsDiv.innerHTML = `
                        <div class="debug-info success">
                            <h3>Debug Results</h3>
                            <p><strong>Configuration:</strong> ${data.configurationName} (ID: ${data.configurationId})</p>
                            <p><strong>Data Counts:</strong> ${data.instancesCount} instances, ${data.usersCount} users, ${data.requestsCount} requests</p>
                        </div>
                        
                        <div class="debug-info">
                            <h4>View Model JSON Fields</h4>
                            <h5>Instances JSON (${data.viewModelInstancesJson.length} chars):</h5>
                            <pre>${data.viewModelInstancesJson}</pre>
                            
                            <h5>Users JSON (${data.viewModelUsersJson.length} chars):</h5>
                            <pre>${data.viewModelUsersJson}</pre>
                            
                            <h5>Requests JSON (${data.viewModelRequestsJson.length} chars):</h5>
                            <pre>${data.viewModelRequestsJson}</pre>
                        </div>
                        
                        <div class="debug-info">
                            <h4>Original Configuration Data</h4>
                            <h5>Original Instances:</h5>
                            <pre>${JSON.stringify(data.originalInstances, null, 2)}</pre>
                            
                            <h5>Original Users:</h5>
                            <pre>${JSON.stringify(data.originalUsers, null, 2)}</pre>
                            
                            <h5>Original Requests:</h5>
                            <pre>${JSON.stringify(data.originalRequests, null, 2)}</pre>
                        </div>
                    `;
                })
                .catch(error => {
                    const resultsDiv = document.getElementById('results');
                    resultsDiv.innerHTML = `
                        <div class="debug-info error">
                            <h3>Error</h3>
                            <p>${error.message}</p>
                        </div>
                    `;
                });
        }
        
        // Auto-fill with the ID from the URL if provided
        const urlParams = new URLSearchParams(window.location.search);
        const configId = urlParams.get('id');
        if (configId) {
            document.getElementById('configId').value = configId;
        }
    </script>
</body>
</html>